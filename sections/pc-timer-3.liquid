<!--
  :danger: ATTENTION : Cette section est la propriété exclusive de PeakConversion.
  Elle est protégée par la loi sur la propriété intellectuelle en vertu de l'article L122-4 du Code de la Propriété Intellectuelle en France.
  Vous n'avez pas le droit de copier, vendre ou redistribuer cette section sous quelque forme que ce soit sans autorisation.
  Pour accéder légalement à ces sections personnalisables, visitez notre site : https://peakconversion.fr/pages/sections-personnalisables
-->
{% liquid
  assign heading = section.settings.heading
  assign heading_size = section.settings.heading_size
  assign heading_weight = section.settings.heading_weight
  assign heading_font = section.settings.heading_font
  assign heading_color = section.settings.heading_color

  assign heading_size_mobile = section.settings.heading_size_mobile

  assign timer_year = section.settings.timer_year
  assign timer_month = section.settings.timer_month
  assign timer_day = section.settings.timer_day
  assign timer_minutes = section.settings.timer_minutes
  assign timer_seconds = section.settings.timer_seconds

  assign timer_day_label = section.settings.timer_day_label
  assign timer_hour_label = section.settings.timer_hour_label
  assign timer_minute_label = section.settings.timer_minute_label
  assign timer_second_label = section.settings.timer_second_label

  assign timer_digits_size = section.settings.timer_digits_size
  assign timer_digits_weight = section.settings.timer_digits_weight
  assign timer_digits_color = section.settings.timer_digits_color
  assign timer_digits_font = section.settings.timer_digits_font

  assign timer_digits_size_mobile = section.settings.timer_digits_size_mobile

  assign timer_units_size = section.settings.timer_units_size
  assign timer_units_weight = section.settings.timer_units_weight
  assign timer_units_color = section.settings.timer_units_color
  assign timer_units_font = section.settings.timer_units_font

  assign timer_units_size_mobile = section.settings.timer_units_size_mobile

  assign button_text = section.settings.button_text
  assign button_url = section.settings.button_url
  assign button_size = section.settings.button_size
  assign button_weight = section.settings.button_weight
  assign button_color = section.settings.button_color
  assign button_font = section.settings.button_font
  assign button_bg_color = section.settings.button_bg_color
  assign button_border_color = section.settings.button_border_color
  assign button_border_width = section.settings.button_border_width
  assign button_border_style = section.settings.button_border_style
  assign button_border_radius = section.settings.button_border_radius

  assign layout_margin_top = section.settings.layout_margin_top
  assign layout_margin_bottom = section.settings.layout_margin_bottom
  assign layout_padding_top = section.settings.layout_padding_top
  assign layout_padding_bottom = section.settings.layout_padding_bottom
  assign layout_background = section.settings.layout_background

  assign layout_margin_top_mobile = section.settings.layout_margin_top_mobile
  assign layout_margin_bottom_mobile = section.settings.layout_margin_bottom_mobile
  assign layout_padding_top_mobile = section.settings.layout_padding_top_mobile
  assign layout_padding_bottom_mobile = section.settings.layout_padding_bottom_mobile
%}
<style>
  .pc-new-countdown-banner-wrapper {
      padding-top: {{ layout_padding_top_mobile}}px;
      padding-bottom: {{  layout_padding_bottom_mobile}}px;
  }

  @media screen and (min-width: 750px) {
      .pc-new-countdown-banner-wrapper {
          padding-top: {{ layout_padding_top}}px;
          padding-bottom: {{ layout_padding_bottom}}px;
      }
  }

  .pc-new-countdown-banner {
      position: relative;
      height: var(--section-height-mobile);
      overflow: hidden;
      margin-top: {{ layout_margin_top_mobile }}px;
      margin-bottom: {{ layout_margin_bottom_mobile }}px;
  }

  @media screen and (min-width: 750px) {
      .pc-new-countdown-banner {
          height: var(--section-height);
          
      margin-top: {{ layout_margin_top }}px;
      margin-bottom: {{ layout_margin_bottom }}px;
      }
  }

  #pc-new-countdown-banner a {
      padding: 10px 15px;
  }

  .pc-new-countdown-banner-content {
      position: relative;
      z-index: 1;
      overflow: hidden;
      width: 100%;
      height: 100%;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      text-align: center;
      line-height: 1.1;
      padding: 16px 5px;
  }

  @media (min-width: 750px) {
      .pc-new-countdown-banner-content {
          gap: 3rem;
      }
  }

  .pc-new-countdown-banner-heading {
      font-weight: {{ heading_weight }};
      font-size: {{heading_size_mobile}}px;
      font-family: {{ heading_font.family }}{% if heading_font.fallback_families != blank  %}, {{ heading_font.fallback_families }}{% endif %} !important;
  }

  @media (min-width: 750px) {
      .pc-new-countdown-banner-heading {
          font-weight: {{ heading_weight }};
          font-size: {{ heading_size }}px;
      }
  }

  .pc-new-timer-div {
      gap: 2rem;
  }

  .pc-new-countdown-timer {
      display: flex;
      justify-content: center;
      gap: 0px;
  }

  @media (min-width: 750px) {
      .pc-new-countdown-timer {
          gap: 0px;
      }

      .pc-new-timer-div {
          gap: 3rem;
      }
  }

  .pc-new-countdown-timer .time-block {
      position: relative;
      border-radius: 12px;
      /*padding: 20px;*/
      padding: 0 0.5rem;
  }

  @media (min-width: 750px) {
      .pc-new-countdown-timer .time-block {
          padding: 0 0.75rem;
      }
  }

  .pc-new-countdown-timer .time-block__num,
  .pc-new-countdown-timer .time-block__unit {
      display: block;
      text-align: center;
  }

  .pc-new-countdown-timer .time-block__num {
      font-size: {{ timer_digits_size }}px;
      font-weight: {{ timer_digits_weight }};
      font-family: {{ timer_digits_font.family }}{% if timer_digits_font.fallback_families != blank  %}, {{ timer_digits_font.fallback_families }}{% endif %} !important;
      line-height: 1;
      color: {{ timer_digits_color }};
  }

  .pc-new-countdown-timer .time-block__unit {
      margin-top: 3px;
      color: {{ timer_units_color }};
      font-size: {{ timer_units_size_mobile }}px;
      font-weight: {{ timer_units_weight }};
      font-family: {{ timer_units_font.family }}{% if timer_units_font.fallback_families != blank  %}, {{ timer_units_font.fallback_families }}{% endif %} !important;
  }

  @media (min-width: 750px) {
      .pc-new-countdown-timer .time-block__unit {
          font-size: {{ timer_units_size }}px;
      }

      .pc-new-countdown-timer .time-block__num {
          font-size: {{ timer_digits_color }}px;
      }

      .pc-new-countdown-timer .time-colon {
          font-weight: {{ timer_digits_weight }};
          font-size: {{ timer_digits_size }}px;
      }
  }

  .pc-new-countdown-timer .time-divier {
      position: relative;
      width: 2px;
      height: 40px;
      background-color: var(--color);
  }

  .pc-new-countdown-timer .time-colon {
      font-weight: {{ timer_digits_weight }};
      font-size: {{ timer_digits_size_mobile }}px;
      color: {{ timer_digits_color }};
  }

  .pc-new-countdown-banner-button {
      padding: 16px 12px;
      text-decoration: none;
  }

  @media (min-width: 750px) {
      .pc-new-countdown-banner-button {
          padding: 16px 25px;
      }
  }

  @media (min-width: 750px) {
      #pc-new-close-button {
          padding: 0 10px 0 0;
      }
  }
</style>
<div class="pc-new-countdown-banner">
  <div>
    <div
      style="--pt: 0px;--pt-desktop: px;--pb: 0px;--pb-desktop: px;background-color: {{ layout_background }};position: relative; "
      class="pc-new-countdown-banner-wrapper"
    >
      <div class="pc-new-countdown-banner page-width">
        <div>
          <div class="pc-new-countdown-banner-content">
            {% if heading != blank %}
            <div class="pc-new-countdown-banner-heading" style="color: {{  heading_color }};">
              {{ heading }}
            </div>
            {% endif %}

            <div
              class="pc-new-timer-div"
              style="display: flex; justify-content: center; align-items: center;"
            >
              <div class="pc-new-countdown-timer" style="">
                <div class="time-block">
                  <span class="time-block__num js-timer-days"> 44</span>
                  <span class="time-block__unit">{{ timer_day_label }}</span>
                </div>
                <span class="time-colon">:</span>
                <div class="time-block">
                  <span class="time-block__num js-timer-hours">12</span>
                  <span class="time-block__unit">{{ timer_hour_label }}</span>
                </div>
                <span class="time-colon">:</span>
                <div class="time-block">
                  <span class="time-block__num js-timer-minutes">07</span>
                  <span class="time-block__unit">{{ timer_minute_label }}</span>
                </div>
                <span class="time-colon">:</span>
                <div class="time-block">
                  <span class="time-block__num js-timer-seconds">40</span>
                  <span class="time-block__unit">{{ timer_second_label }}</span>
                </div>
              </div>
            {% if button_text != blank %}
              <a
                href="{{ button_url }}"
                class="pc-new-countdown-banner-button"
                style="color: {{ button_color }};
                      background-color: {{ button_bg_color}};
                      border-radius: {{ button_border_radius }}px;
                      font-size: {{ button_size }}px;font-weight:{{ button_weight }};
                      border: {{ button_border_width }}px {{ button_border_style }} {{ button_border_color }};"
              >
                {{ button_text }}
              </a>
            {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div
        style="position: absolute;top: 50%;right: 0;transform: translateY(-50%);padding: 0 5px 0 0;color: gray;cursor: pointer; z-index: 1000;"
        id="pc-new-close-button"
      >
        <svg
          stroke="currentColor"
          fill="currentColor"
          stroke-width="0"
          viewBox="0 0 512 512"
          height="1em"
          width="1em"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
              d="M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 256 285.798 375.202 405 285.798 256z">
          </path>
        </svg>
      </div>
    </div>
  </div>
  <div id="pc-new-countdown-default-target"></div>
</div>

{% schema %}
{
    "name": "PC - Timer #3",
    "settings": [
        {
            "type": "header",
            "content": "This section is a property of PeakConversion",
            "info": "Do not sell or reproduce. contact us at franklinjounda@gmail.com for more info"
        },
        {
            "type": "header",
            "content": "Heading Settings"
        },
        {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "☀️ BLACK FRIDAY! 70% OFF Until ☀️"
        },
        {
            "type": "range",
            "id": "heading_size",
            "label": "Heading Size",
            "default": 20,
            "min": 10,
            "max": 50
        },
        {
            "type": "select",
            "id": "heading_weight",
            "label": "Heading Weight",
            "default": "700",
            "options": [
                {
                    "value": "400",
                    "label": "Normal"
                },
                {
                    "value": "700",
                    "label": "Bold"
                }
            ]
        },
        {
            "type": "font_picker",
            "id": "heading_font",
            "label": "Heading Font",
            "default": "josefin_sans_n4"
        },
        {
            "type": "color",
            "id": "heading_color",
            "label": "Heading Color",
            "default": "#ffffff"
        },
        {
            "type": "header",
            "content": "Timer Settings"
        },
        {
            "type": "text",
            "id": "timer_year",
            "label": "Timer Year",
            "default": "2025"
        },
        {
            "type": "text",
            "id": "timer_month",
            "label": "Timer Month",
            "default": "12"
        },
        {
            "type": "text",
            "id": "timer_day",
            "label": "Timer Day",
            "default": "15"
        },
        
        {
            "type": "text",
            "id": "timer_day_label",
            "label": "Timer Day Label",
            "default": "Days"
        },
        {
            "type": "text",
            "id": "timer_hour_label",
            "label": "Timer Hour Label",
            "default": "Hrs"
        },
        {
            "type": "text",
            "id": "timer_minute_label",
            "label": "Timer Minute Label",
            "default": "Mins"
        },
        {
            "type": "text",
            "id": "timer_second_label",
            "label": "Timer Second Label",
            "default": "Secs"
        },
        {
            "type": "range",
            "id": "timer_digits_size",
            "label": "Timer Digits Size",
            "default": 17,
            "min": 10,
            "max": 50
        },
        {
            "type": "select",
            "id": "timer_digits_weight",
            "label": "Timer Digits Weight",
            "default": "700",
            "options": [
                {
                    "value": "400",
                    "label": "Normal"
                },
                {
                    "value": "700",
                    "label": "Bold"
                }
            ]
        },
        {
            "type": "color",
            "id": "timer_digits_color",
            "label": "Timer Digits Color",
            "default": "#ffffff"
        },
        {
            "type": "font_picker",
            "id": "timer_digits_font",
            "label": "Timer Digits Font",
            "default": "josefin_sans_n4"
        },
        {
            "type": "range",
            "id": "timer_digits_size_mobile",
            "label": "Timer Digits Size Mobile",
            "default": 14,
            "min": 10,
            "max": 50
        },
        {
            "type": "range",
            "id": "timer_units_size",
            "label": "Timer Units Size",
            "default": 9,
            "min": 5,
            "max": 20
        },
        {
            "type": "select",
            "id": "timer_units_weight",
            "label": "Timer Units Weight",
            "default": "400",
            "options": [
                {
                    "value": "400",
                    "label": "Normal"
                },
                {
                    "value": "700",
                    "label": "Bold"
                }
            ]
        },
        {
            "type": "color",
            "id": "timer_units_color",
            "label": "Timer Units Color",
            "default": "#ffffff"
        },
        {
            "type": "font_picker",
            "id": "timer_units_font",
            "label": "Timer Units Font",
            "default": "josefin_sans_n4"
        },
        {
            "type": "range",
            "id": "timer_units_size_mobile",
            "label": "Timer Units Size Mobile",
            "default": 8,
            "min": 5,
            "max": 20
        },
        {
            "type": "header",
            "content": "Button Settings"
        },
        {
            "type": "text",
            "id": "button_text",
            "label": "Button Text",
            "default": "SHOP NOW"
        },
        {
            "type": "url",
            "id": "button_url",
            "label": "Button URL"
        },
        {
            "type": "range",
            "id": "button_size",
            "label": "Button Size",
            "default": 13,
            "min": 10,
            "max": 30
        },
        {
            "type": "select",
            "id": "button_weight",
            "label": "Button Weight",
            "default": "700",
            "options": [
                {
                    "value": "400",
                    "label": "Normal"
                },
                {
                    "value": "700",
                    "label": "Bold"
                }
            ]
        },
        {
            "type": "color",
            "id": "button_color",
            "label": "Button Color",
            "default": "#ffffff"
        },
        {
            "type": "font_picker",
            "id": "button_font",
            "label": "Button Font",
            "default": "josefin_sans_n4"
        },
        {
            "type": "color",
            "id": "button_bg_color",
            "label": "Button Background Color",
            "default": "#03bc8d"
        },
        {
            "type": "color",
            "id": "button_border_color",
            "label": "Button Border Color",
            "default": "#ffffff"
        },
        {
            "type": "range",
            "id": "button_border_width",
            "label": "Button Border Width",
            "default": 0,
            "min": 0,
            "max": 10
        },
        {
            "type": "select",
            "id": "button_border_style",
            "label": "Button Border Style",
            "default": "solid",
            "options": [
                {
                    "value": "solid",
                    "label": "Solid"
                },
                {
                    "value": "dotted",
                    "label": "Dotted"
                },
                {
                    "value": "dashed",
                    "label": "Dashed"
                }
            ]
        },
        {
            "type": "range",
            "id": "button_border_radius",
            "label": "Button Border Radius",
            "default": 6,
            "min": 0,
            "max": 20
        },
        {
            "type": "range",
            "id": "button_size_mobile",
            "label": "Button Size Mobile",
            "default": 12,
            "min": 10,
            "max": 30
        },
        {
            "type": "header",
            "content": "Layout Settings"
        },
        {
            "type": "range",
            "id": "layout_margin_top",
            "label": "Layout Margin Top",
            "default": 0,
            "min": 0,
            "max": 99
        },
        {
            "type": "range",
            "id": "layout_margin_bottom",
            "label": "Layout Margin Bottom",
            "default": 0,
            "min": 0,
            "max": 99
        },
        {
            "type": "range",
            "id": "layout_padding_top",
            "label": "Layout Padding Top",
            "default": 0,
            "min": 0,
            "max": 99
        },
        {
            "type": "range",
            "id": "layout_padding_bottom",
            "label": "Layout Padding Bottom",
            "default": 0,
            "min": 0,
            "max": 99
        },
        {
            "type": "color",
            "id": "layout_background",
            "label": "Layout Background",
            "default": "#000000"
        },
        {
            "type": "range",
            "id": "layout_margin_top_mobile",
            "label": "Layout Margin Top Mobile",
            "default": 0,
            "min": 0,
            "max": 50
        },
        {
            "type": "range",
            "id": "layout_margin_bottom_mobile",
            "label": "Layout Margin Bottom Mobile",
            "default": 0,
            "min": 0,
            "max": 50
        },
        {
            "type": "range",
            "id": "layout_padding_top_mobile",
            "label": "Layout Padding Top Mobile",
            "default": 0,
            "min": 0,
            "max": 50
        },
        {
            "type": "range",
            "id": "layout_padding_bottom_mobile",
            "label": "Layout Padding Bottom Mobile",
            "default": 0,
            "min": 0,
            "max": 50
        }
    ],
    "presets": [
        {
            "category": "Promotional",
            "name": "PC - Timer #3"
        }
    ]
}
{% endschema %}
<script type="text/javascript">
  (function () {
      function startTimer() {
          const second = 1000,
              minute = second * 60,
              hour = minute * 60,
              day = hour * 24,
              wrapper = document.querySelector(
                  '.pc-new-countdown-timer'
              );

          const targetDate = new Date(Date.UTC(
              parseInt('{{ timer_year }}', 10),
              parseInt('{{ timer_month }}', 10) - 1,
              parseInt('{{ timer_day }}', 10),
              parseInt('00', 10),
              parseInt('00', 10),
              0
          ));

          const countDown = targetDate.getTime();
          console.log('Announcement bar timer end date:', new Date(countDown).toISOString());

          const interval = setInterval(function () {
              let now = Date.now(),
                  distance = countDown - now,
                  days = Math.floor(distance / day),
                  hours = Math.floor((distance % day) / hour),
                  minutes = Math.floor((distance % hour) / minute),
                  seconds = Math.floor((distance % minute) / second);

              (wrapper.querySelector('.js-timer-days').innerText =
                  (days < 10 ? '0' : '') + days),
                  (wrapper.querySelector('.js-timer-hours').innerText = (
                      '0' + hours
                  ).slice(-2)
                  ),
                  (wrapper.querySelector('.js-timer-minutes').innerText = (
                      '0' + minutes
                  ).slice(-2)),
                  (wrapper.querySelector('.js-timer-seconds').innerText = (
                      '0' + seconds
                  ).slice(-2));

              if (distance < 0) {
                  wrapper.querySelector('.js-timer-days').innerText = '00';
                  wrapper.querySelector('.js-timer-hours').innerText = '00';
                  wrapper.querySelector('.js-timer-minutes').innerText = '00';
                  wrapper.querySelector('.js-timer-seconds').innerText = '00';

                  clearInterval(interval);
              }
          }, second);

          document.addEventListener('shopify:section:unload', function (event) {
              if (event.detail.sectionId === 'pc-new-countdown-banner') clearInterval(interval);
          });
      }

      startTimer();
  })();
</script>

<script type="text/javascript">
  let btnClose = document.getElementById('pc-new-close-button');
  btnClose.addEventListener('click', function (e) {
      e.preventDefault()
      document.getElementById('pc-new-countdown-banner-wrapper').style.display = 'none';
  });
</script>
